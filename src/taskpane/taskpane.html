<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RFQ Copilot</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script src="https://alcdn.msauth.net/browser/2.38.0/js/msal-browser.min.js"></script>
</head>
<body>
  <header class="header">
    <div class="header-left">
      <span id="header-title" class="header-brand">RFQ Copilot</span>
      <button id="sign-in-btn" class="btn btn-primary" type="button">Sign In</button>
      <span id="account-divider" class="account-divider hidden">|</span>
      <span id="user-name" class="user-name hidden"></span>
    </div>
    <button id="sign-out-btn" class="btn btn-secondary hidden" type="button" title="Sign Out">Sign Out</button>
  </header>

  <main class="main">
    <p id="status-message" class="status-message"></p>

    <!-- Neutral: no email or other email -->
    <div id="context-neutral" class="context-block">
      <div class="neutral-message" id="neutral-message-text">
        Open an RFQ from customer-1 or a reply from Engineering to use the copilot.
      </div>
    </div>

    <!-- Initial RFQ from customer-1: full parsing UI -->
    <div id="context-initial-rfq" class="context-block">
      <p class="section-title">Technical specifications</p>
      <div class="card">
        <div id="specs-grid" class="specs-grid"></div>
      </div>

      <p class="section-title">Customer questions</p>
      <div id="customer-questions-accordion" class="accordion"></div>

      <p class="section-title">Missing details</p>
      <ul id="missing-details-list" class="detail-list"></ul>

      <p class="section-title">Questions to ask customer</p>
      <ul id="questions-to-ask-list" class="question-list"></ul>

      <div class="actions-block">
        <p class="section-title">Actions</p>
        <button id="send-rfq-btn" class="btn btn-primary" type="button" disabled>Send to Engineering Review</button>
        <button id="reply-direct-to-customer-btn" class="btn btn-secondary" type="button" disabled>Reply Directly to Customer</button>
      </div>
    </div>

    <!-- Engineering reply: show answers, send clarifications to customer -->
    <div id="context-engineering-reply" class="context-block">
      <p class="section-title">Engineering assessment</p>
      <div id="engineering-answers-container" class="engineering-answers"></div>
      <div class="actions-block">
        <button id="reply-to-original-btn" class="btn btn-primary" type="button" disabled>Send Clarifications to Customer</button>
      </div>
    </div>

    <!-- Customer reply with details: all complete, send final quote -->
    <div id="context-customer-reply-details" class="context-block">
      <div class="complete-message">
        <p class="section-title">All details complete</p>
        <p>No technical details are missing. No open questions. The NRL specification sheet and PDF quote are ready to send.</p>
      </div>
      <div class="actions-block">
        <button id="send-final-reply-btn" class="btn btn-primary" type="button" disabled>Send Final Quote to Customer</button>
      </div>
    </div>
  </main>

  <script src="/services/auth.js"></script>
  <script src="/data/rfq-data.js"></script>
  <script src="/data/email-templates.js"></script>
  <script src="taskpane.js"></script>
</body>
</html>
